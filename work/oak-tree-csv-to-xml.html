<!doctype html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1">
    <title>Oak Tree | CSV to XML Parser</title>

   <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

  </head>

  <body>

    Path: <input id="pathTxt" style="width:450px" type="text" name="pathTxt" value="Oak Tree Export - Sheet1.csv">
    <br/><br/>
     <button type="button" onclick="makeXML()">Make XML</button>
     <button type="button" onclick="clearXML()">Clear</button>
     <br/><br/>
    <textarea id="txtoutput" style='width:70%; height:500px'></textarea>
    <br/><br/>
    Format: <a href="http://www.freeformatter.com/xml-formatter.html" target="_blank">XML Makeover</a>

  </body>

  <script type="text/javascript">

    var clearXML = function(){
      //Clear text area of anything previous
      document.getElementById("txtoutput").value='';
    }



    var makeXML = function(){

    var specimens = '<xxx><config><!-- ======== --><!-- SETTINGS --><!-- ======== --><settings><setting id="example_setting" value="example_value" /></settings><!-- ======== --><!-- LANGUAGE --><!-- ======== --><component id="oak_tree_specimens"><specimens></specimens></component></config></xxx>';

    var config = $.parseHTML( specimens );

    //load html to parse
    var indexPath = document.getElementById("pathTxt").value;

    $.get(indexPath+'').success( function(data) {

        console.log(data.split('\n')); //split by new line

        // console.log(data.split('Component #')); //split by new line
        var components = data.split('Component # 813\n Mountains\n \n XID: ');

        console.log(components.length);
        components.forEach(function( c ) {

            console.log( c.substring(0, 100) );

            var commonEnglish = '';
            var scientific = '';
            var descriptionEnglish = '';
            var commonSpanish = '';
            var descriptionSpanish = '';

        });


        /*

        $(data).find('.item').each(function(index) {





          var s = $.parseHTML( '<!-- SLIDE '+index+' --><slide></slide>' );

          var id = 'slide_'+index;
          var cls = ""; //get exception classes
          if ($(this).find('.carousel-caption-title').length > 0) cls = 'title';
          if ($(this).find('.carousel-caption-bottom').length > 0) cls = 'bottom';
          var isrc = $(this).find('img').first().attr('src');

          //set slide attributes
          $(s).attr('id', id);
          $(s).attr('class', cls);
          $(s).attr('imgSrc', isrc);

          //Add head text
          var head = $.parseHTML( '<text id="head"><en></en><es></es></text>' );

          //English title
          var getEng = $(this).find('h2').html();
          if( getEng==''|| getEng==undefined ) getEng = $(this).find('h1').html();

          //Spanish title
          var getEsp = $(spanishData).find('.item').eq(index).find('h2').html();
          if(getEsp==''||getEsp==undefined) getEsp = $(spanishData).find('.item').eq(index).find('h1').html();

          //Set XML
          $(head).find('en').html( getEng );
          $(head).find('es').html( getEsp );

          //Add description text
          var descr = $.parseHTML( '<text id="description"><en></en><es></es></text>' );
          var getEngd = $(this).find('p').html();
          var getEspd = $(spanishData).find('.item').eq(index).find('p').html();

          $(descr).find('en').html( getEngd );
          $(descr).find('es').html( getEspd );

          $(s).append(head);
          $(s).append(descr);

          //add slide config
          $(config).find('specimens').append(s);



        });

        */

        //Send to text area
        document.getElementById("txtoutput").value = $(config).html();

    });

  }

  //auto on refresh
  makeXML();

  </script>

</html>